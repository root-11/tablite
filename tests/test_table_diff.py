from tablite import Table


def test_diff():
    s1 = [1,2,3,4,5,1,2,3,4,5]
    s2 = [2,2,2,2,3,3,3,3,4,4]
    s3 = [1,1,1,1,1,1,1]

    t1 = Table.from_dict({'A': s1, 'B': s2})
    t2 = Table.from_dict({'A': s3 + s1 + s3, 'B': s3 + s2 + s3})

    t3 = t1.diff(t2)
    t3.show(slice(None))
    # +===+===+===+===+===+
    # | # | A | B |1st|2nd|
    # |row|int|int|str|str|
    # +---+---+---+---+---+
    # |0  |  1|  1|-  |+  |
    # |1  |  1|  1|-  |+  |
    # |2  |  1|  1|-  |+  |
    # |3  |  1|  1|-  |+  |
    # |4  |  1|  1|-  |+  |
    # |5  |  1|  1|-  |+  |
    # |6  |  1|  1|-  |+  |
    # |7  |  1|  2|=  |=  |
    # |8  |  2|  2|=  |=  |
    # |9  |  3|  2|=  |=  |
    # |10 |  4|  2|=  |=  |
    # |11 |  5|  3|=  |=  |
    # |12 |  1|  3|=  |=  |
    # |13 |  2|  3|=  |=  |
    # |14 |  3|  3|=  |=  |
    # |15 |  4|  4|=  |=  |
    # |16 |  5|  4|=  |=  |
    # |17 |  1|  1|-  |+  |
    # |18 |  1|  1|-  |+  |
    # |19 |  1|  1|-  |+  |
    # |20 |  1|  1|-  |+  |
    # |21 |  1|  1|-  |+  |
    # |22 |  1|  1|-  |+  |
    # |23 |  1|  1|-  |+  |
    # +===+===+===+===+===+
    assert t3['1st'].count('=') == len(s1)
    assert len(t3['1st']) == len(t2)
    assert t3['1st'].count('-') == len(t2) - len(t1)


